"0","#Run a loop for each year in a vector of years where you:"
"0","#   - extract year data"
"0","#   - store in df"
"0","#   - run mem-pep Reco on that data"
"0","#   - store df as element of list"
"0",""
"0",""
"0","#3.a) pull your reco function in and setup storage space"
"0","source('./Peprmt_files/PEPRMT_final_sys_CO2_Reco_reduced.R')"
"0","year_vector <- c(2018,2019,2020,2021)"
"0","outcome_lst <- list(rep(NA, length(year_vector)))"
"0","daysofyear <- list(c(47, 365), c(366,730), c(731,1096),c(1097,1263))"
"0","wetland_type <- ""coastal"" #set to ""peatland"" for Deltas impounded wetlands"
"0","     "
"0","#3.b) run the loop"
"0","  for(i in 1:length(year_vector)) {"
"0","    cohort_i <- cohort %>%"
"0","      filter(year == year_vector[i]) %>%"
"0","      mutate(depth = layer_bottom - layer_top)"
"0","    "
"0","    # set up your theta values. note that multiply by 10^6 to"
"0","    #convert from gC/cm^3 to gC/m^2, when we consider one meter"
"0","    #of soil across all years of interest."
"0","    #THIS PARAMETER COULD ALSO BE MEASURED SOC IN gC/M2"
"0","    theta5 <- (mean(cohort_i$slow_OM*.5)/mean(cohort_i$depth*.5))*1000000"
"0","    "
"0","    #theta6-sum up the MEM modeled respired OM for the given year"
"0","    #IF RUNNING FOR IMPOUNDED PEATLAND SET THIS TO 0s"
"0","    theta6 <- sum(cohort_i$respired_OM)*1000000"
"0","     # run peprmt Reco"
"0","    theta <- c(1.5, 0, 1.5, 0, theta5, theta6)"
"0","    ER_mod_RR <- PEPRMT_final_sys_CO2_Reco(data,"
"0","                                           theta,wetland_type)"
"0","    "
"0","    # merge peprmt output + obs data"
"0","    co2_i <- ER_mod_RR %>%"
"0","      as.data.frame(.) %>%"
"0","      mutate(DOY = c(data$Discont_day_of_year),"
"0","             DOY_cont = c(data$Day_of_year)) %>%"
"0","      select(Reco_full,"
"0","             DOY, "
"0","             DOY_cont,#,"
"0","             S1,"
"0","             S2"
"0","             ) %>%"
"0","      rename(CO2_flux=Reco_full) %>%"
"0","      mutate(data_type = c(rep(paste0(""mem_pep_"",year_vector[i],sep=""""),"
"0","                               nrow(.)))) "
"0","    "
"0","    #filter the data between min & max values of obs data"
"0","    #for given year"
"0","    s <- unlist(daysofyear[i])"
"0","    co2_i <- co2_i %>%"
"0","      slice(s[1]:s[2])"
"0","    "
"0","    #store your dataframe iteration of Reco into the list"
"0","    outcome_lst[[i]] <- co2_i"
"0","  }"
"0",""
"0","#save Reco output into data file"
"0","data[10] <- ER_mod_RR$S1"
"0","data[11] <- ER_mod_RR$S2"
"0",""
"0"," #export as csv file"
"0","   # write.csv(ER_mod_RR,'EL_data_Reco_mod.csv') "
